// Display the mode-line
mode_line_mode(true);

// Disable clock in modeline
remove_hook("mode_line_hook", mode_line_adder(clock_widget));

// Disable scroll position in modeline
remove_hook("mode_line_hook", mode_line_adder(current_buffer_scroll_position_widget));

// Allow to install extensions
session_pref("xpinstall.whitelist.required", false);


/* -------- Imports --------- */

// I'd like to have tabs
require("new-tabs.js");

// Load github mode
require("github");

// Click to open new tabs
require("clicks-in-new-buffer.js");


/* -------- User Defined Functions --------- */

interactive("search-clipboard-contents", "Search in Google the content of the X clipboard (the selected text)",
              "find-url",
              $browser_object=
              function(I) {
                  return "google "+ read_from_x_primary_selection();
              }
);


/* -------- User Variables --------- */

// Display the url before going to it in hints mode
hints_display_url_panel = true;

// Auto completion in the minibuffer
minibuffer_auto_complete_default = true;
url_completion_use_history = true; // Should work since bf05c87405
url_completion_use_bookmarks = true;

// Set to either OPEN_NEW_BUFFER or OPEN_NEW_BUFFER_BACKGROUND
clicks_in_new_buffer_target = OPEN_NEW_BUFFER_BACKGROUND; // Now buffers open in background.

// Set to 0 = left mouse, 1 = middle mouse, 2 = right mouse
clicks_in_new_buffer_button = 2; //  Now right mouse follows links in new buffers.

// Set default download directory
cwd=get_home_directory();
cwd.append("downloads");

can_kill_last_buffer = false;

// xkcd add mouse-over text
xkcd_add_title = true;


/* -------- Protocol Handlers --------- */

set_protocol_handler("mailto", find_file_in_path("thunderbird"));


/* -------- Content Handlers --------- */

external_content_handlers.set("application/pdf", "pdfviewer");

/* -------- Key Bindings --------- */

// Redefine C-f as "forwards" and C-b as "backwards"
define_key(content_buffer_normal_keymap, "C-f", "forward");
define_key(content_buffer_normal_keymap, "C-b", "back");

// Make M-f and M-b switch to next and previous buffers
define_key(content_buffer_normal_keymap, "C-tab", "buffer-next");
define_key(content_buffer_normal_keymap, "C-S-tab", "buffer-previous");

// Use C-l to follow link in new background buffer
define_key(default_global_keymap, "C-l", "follow-new-buffer-background");

// Use M-y to search with google for the clipboard content
define_key(content_buffer_normal_keymap, "M-y", "search-clipboard-contents");

// make C-c C-c "submit form"
define_key(content_buffer_normal_keymap, "C-c C-c", "submit-form");


/* -------- Web Jumps --------- */
define_webjump("hoogle", "http://haskell.org/hoogle/?hoogle=%s",
               $alternative = "http://haskell.org/hoogle/");

define_webjump("hackage", "http://google.com/search?as_sitesearch=hackage.haskell.org%2Fpackage&as_q=%s");

